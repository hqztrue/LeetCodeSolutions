Consider the rows and cols separately. O(sort(hBars.length+vBars.length)).

