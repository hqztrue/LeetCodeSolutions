topological sort. O(n+m).
