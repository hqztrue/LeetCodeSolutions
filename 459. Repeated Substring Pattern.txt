use the "next" array in KMP. O(n).
