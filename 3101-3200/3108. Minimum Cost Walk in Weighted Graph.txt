We should greedily visit the whole connected component. O(n+m+q).



