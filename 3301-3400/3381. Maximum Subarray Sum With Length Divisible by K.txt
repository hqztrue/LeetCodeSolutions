prefix sum+greedy. O(n).

