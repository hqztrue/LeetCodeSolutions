Maintain a stack for each character. O(n).

